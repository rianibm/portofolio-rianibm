---
const today = new Date();
import { Icon } from "astro-icon/components";
import Analytics from "@vercel/analytics/astro";
---

<footer
  class="flex flex-col items-center container mx-auto p-10 text-center gap-10 pb-40"
>
  <p>&copy; {today.getFullYear()} rianibm. All rights reserved.</p>
  <div class="flex items-center gap-6 text-5xl">
    <a
      href="mailto:rianimatialu@gmail.com"
      target="_blank"
      rel="noopener noreferrer"
      aria-label="Email Riani BM"
      class="py-1 pl-3 rounded-md border-1 border-black bg-ppink shadow-card hover:shadow-hover transition animate-on-scroll scale-in"
      style="--delay: 0s"
    >
      <Icon name="web" aria-hidden="true" />
    </a>
    <a
      href="https://github.com/rianibm"
      target="_blank"
      rel="noopener noreferrer"
      aria-label="GitHub Riani BM"
      class="border-1 p-1 border-black rounded-full bg-pblue shadow-card hover:shadow-hover transition animate-on-scroll scale-in"
      style="--delay: 0.1s"
    >
      <Icon name="github" aria-hidden="true" />
    </a>
    <a
      href="https://www.linkedin.com/in/rianibm/"
      target="_blank"
      rel="noopener noreferrer"
      aria-label="LinkedIn Riani BM"
      class="border-1 p-1 border-black rounded-full bg-pgreen shadow-card hover:shadow-hover transition animate-on-scroll scale-in"
      style="--delay: 0.2s"
    >
      <Icon name="linkedin" aria-hidden="true" />
    </a>
  </div>
  <button
    id="reduce-motion-toggle"
    type="button"
    class="text-xs px-3 py-1.5 rounded-full border border-gray-300 text-gray-500 hover:text-black hover:border-black transition-colors"
    aria-pressed="false"
  >
    Reduce animations
  </button>
</footer>
<Analytics />
<script is:inline>
  (function () {
    var KEY = "reduce-motion";

    function apply(enabled) {
      document.documentElement.classList.toggle("reduce-motion", enabled);

      document.querySelectorAll(".animate-on-scroll").forEach(function (el) {
        if (enabled) el.classList.add("animated");
      });

      var btn = document.getElementById("reduce-motion-toggle");
      if (btn) {
        btn.setAttribute("aria-pressed", String(enabled));
        btn.textContent = enabled ? "Enable animations" : "Reduce animations";
      }
    }

    // OS preference
    var prefersReducedMotion = window.matchMedia(
      "(prefers-reduced-motion: reduce)",
    ).matches;

    // localStorage override or OS preference
    var stored = localStorage.getItem(KEY);
    var enabled = stored !== null ? stored === "true" : prefersReducedMotion;
    apply(enabled);

    function initToggle() {
      var btn = document.getElementById("reduce-motion-toggle");
      if (!btn) return;
      btn.setAttribute("aria-pressed", String(enabled));
      btn.textContent = enabled ? "Enable animations" : "Reduce animations";
      btn.addEventListener("click", function () {
        enabled = !enabled;
        localStorage.setItem(KEY, String(enabled));
        apply(enabled);
      });
    }

    initToggle();
    document.addEventListener("astro:after-swap", function () {
      apply(enabled);
      initToggle();
    });
  })();
</script>
